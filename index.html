<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>MU-TH-UR 9000 // KYRONEX DEEP SPACE</title>
<link href="https://fonts.googleapis.com/css2?family=VT323&family=Share+Tech+Mono&display=swap" rel="stylesheet"/>
<style>
:root{
  --amber:#ffaa00;
  --amber-dim:#7a4f00;
  --amber-glow:rgba(255,170,0,0.18);
  --amber-faint:rgba(255,170,0,0.06);
  --green:#00ff41;
  --green-dim:#003d0f;
  --red:#ff2200;
  --red-glow:rgba(255,34,0,0.25);
  --cyan:#00ccdd;
  --bg:#000;
  --vt:'VT323',monospace;
  --mono:'Share Tech Mono',monospace;
}
*{box-sizing:border-box;margin:0;padding:0;}
html,body{height:100%;width:100%;background:#000;overflow:hidden;cursor:none;}

/* ── ÉCRAN DE DÉMARRAGE ─────────────────────────────────── */
#boot-screen{
  position:fixed;inset:0;background:#000;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  z-index:9000;gap:32px;
}
#boot-logo{
  font-family:var(--vt);font-size:11px;color:var(--amber);
  text-align:center;line-height:1.15;
  text-shadow:0 0 20px var(--amber),0 0 40px rgba(255,170,0,0.4);
  opacity:0;animation:fadeIn 2s ease 0.5s forwards;
  letter-spacing:2px;
}
#boot-logo pre{display:inline-block;}
#start-btn{
  font-family:var(--vt);font-size:28px;color:#000;
  background:var(--amber);border:none;
  padding:12px 40px;cursor:pointer;letter-spacing:4px;
  animation:fadeIn 2s ease 1.5s forwards, btnPulse 2s ease-in-out 3s infinite;
  opacity:0;
  text-shadow:none;
  transition:all 0.2s;
}
#start-btn:hover{background:#fff;color:#000;box-shadow:0 0 30px var(--amber);}
@keyframes fadeIn{to{opacity:1}}
@keyframes btnPulse{0%,100%{box-shadow:0 0 10px var(--amber)}50%{box-shadow:0 0 30px var(--amber),0 0 60px rgba(255,170,0,0.3)}}

/* ── SCANLINES + PHOSPHOR ───────────────────────────────── */
#overlay-scanlines{
  position:fixed;inset:0;pointer-events:none;z-index:8000;
  background:repeating-linear-gradient(
    0deg,
    rgba(0,0,0,0.22) 0px,rgba(0,0,0,0.22) 1px,
    transparent 1px,transparent 3px
  );
}
#overlay-phosphor{
  position:fixed;inset:0;pointer-events:none;z-index:7999;
  background:rgba(255,140,0,0.022);
  animation:phosphorFlicker 0.1s infinite;
}
#overlay-vignette{
  position:fixed;inset:0;pointer-events:none;z-index:7998;
  background:radial-gradient(ellipse at center,transparent 55%,rgba(0,0,0,0.85) 100%);
}
@keyframes phosphorFlicker{
  0%{opacity:0.9}30%{opacity:1}60%{opacity:0.95}80%{opacity:1}100%{opacity:0.92}
}

/* ── LAYOUT PRINCIPAL ───────────────────────────────────── */
#main{
  display:none;
  position:fixed;inset:0;
  padding:10px;gap:8px;
  flex-direction:column;
}
#main.active{display:flex;}

/* Ligne haute */
#row-top{
  display:flex;gap:8px;flex-shrink:0;height:36px;
  align-items:center;
}
/* Ligne centrale */
#row-mid{
  display:flex;gap:8px;flex:1;min-height:0;
}
/* Ligne basse */
#row-bot{
  display:flex;gap:8px;flex-shrink:0;height:80px;
}

/* ── PANNEAUX ────────────────────────────────────────────── */
.panel{
  border:1px solid var(--amber-dim);
  background:rgba(255,140,0,0.03);
  position:relative;
  overflow:hidden;
}
.panel::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(180deg,rgba(255,170,0,0.04) 0%,transparent 100%);
  pointer-events:none;
}
.pnl-hdr{
  font-family:var(--vt);font-size:16px;color:var(--amber-dim);
  letter-spacing:2px;padding:4px 8px 2px;
  border-bottom:1px solid var(--amber-dim);
  background:rgba(255,170,0,0.04);
  display:flex;justify-content:space-between;align-items:center;
}
.pnl-hdr span{font-size:12px;color:var(--amber-dim);}
.pnl-body{padding:6px 8px;overflow:hidden;height:calc(100% - 28px);}

/* Glow amber sur texte actif */
.amber{color:var(--amber);text-shadow:0 0 8px rgba(255,170,0,0.5);}
.amber-bright{color:var(--amber);text-shadow:0 0 14px var(--amber),0 0 28px rgba(255,170,0,0.3);}
.green-txt{color:var(--green);text-shadow:0 0 8px rgba(0,255,65,0.4);}
.red-txt{color:var(--red);text-shadow:0 0 10px var(--red-glow),0 0 20px rgba(255,34,0,0.2);}
.dim{color:var(--amber-dim);}

/* ── HEADER BARRE ────────────────────────────────────────── */
#hdr-bar{
  flex:1;display:flex;align-items:center;justify-content:space-between;
  padding:0 10px;border:1px solid var(--amber-dim);
  background:rgba(255,170,0,0.04);
}
#hdr-title-txt{
  font-family:var(--vt);font-size:20px;
  color:var(--amber);letter-spacing:4px;
  text-shadow:0 0 12px var(--amber),0 0 30px rgba(255,170,0,0.3);
}
#hdr-right{
  font-family:var(--mono);font-size:10px;color:var(--amber-dim);
  letter-spacing:2px;display:flex;gap:20px;align-items:center;
}
.blink-dot{
  display:inline-block;width:6px;height:6px;border-radius:50%;
  background:var(--green);box-shadow:0 0 6px var(--green);
  animation:blink 1.2s step-end infinite;margin-right:4px;
}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}
.blink-dot.red{background:var(--red);box-shadow:0 0 6px var(--red);}
.blink-dot.amber-d{background:var(--amber);box-shadow:0 0 6px var(--amber);}

/* ── PANNEAU SCHÉMA VAISSEAU ─────────────────────────────── */
#panel-ship{flex:2.2;min-width:0;}
#ship-svg{width:100%;height:100%;}

/* ── PANNEAU TERMINAL CENTRAL ────────────────────────────── */
#panel-terminal{flex:2;min-width:0;}
#terminal-out{
  height:100%;overflow-y:auto;overflow-x:hidden;
  font-family:var(--vt);font-size:18px;line-height:1.4;
  scrollbar-width:thin;scrollbar-color:var(--amber-dim) transparent;
  padding:2px 4px;
}
#terminal-out::-webkit-scrollbar{width:3px;}
#terminal-out::-webkit-scrollbar-thumb{background:var(--amber-dim);}
.t-line{animation:lineReveal 0.1s ease-out;}
@keyframes lineReveal{from{opacity:0}to{opacity:1}}
.t-cursor{
  display:inline-block;width:10px;height:17px;
  background:var(--amber);vertical-align:text-bottom;
  animation:cursorBlink 0.6s step-end infinite;
  box-shadow:0 0 8px var(--amber);
}
@keyframes cursorBlink{0%,100%{opacity:1}50%{opacity:0}}

/* ── PANNEAU RADAR ───────────────────────────────────────── */
#panel-radar{flex:1;min-width:0;}
#radar-svg{width:100%;height:100%;}

/* ── PANNEAU STATUS ÉQUIPAGE ─────────────────────────────── */
#panel-crew{width:170px;flex-shrink:0;}
.crew-entry{
  font-family:var(--mono);font-size:9px;
  color:var(--amber-dim);
  padding:4px 6px 3px;
  border-bottom:1px solid rgba(255,170,0,0.08);
  transition:color 0.5s;
}
.crew-entry .cn{color:var(--amber);letter-spacing:1px;font-size:10px;}
.crew-entry .cs{float:right;font-size:9px;}
.crew-entry.ok .cs{color:var(--green);}
.crew-entry.warn .cs{color:var(--amber);}
.crew-entry.crit .cs{color:var(--red);animation:textBlink 0.8s step-end infinite;}
@keyframes textBlink{0%,100%{opacity:1}50%{opacity:0}}

/* ── PANNEAU METRICS BAS ─────────────────────────────────── */
#panel-metrics{flex:1;}
.metric-row{
  display:flex;align-items:center;gap:6px;
  font-family:var(--mono);font-size:9px;color:var(--amber-dim);
  padding:2px 0;letter-spacing:1px;
}
.metric-label{width:90px;flex-shrink:0;}
.metric-bar-wrap{flex:1;height:8px;background:rgba(255,170,0,0.08);border:1px solid rgba(255,170,0,0.15);position:relative;overflow:hidden;}
.metric-bar{height:100%;background:var(--amber);box-shadow:0 0 6px rgba(255,170,0,0.4);width:0%;transition:width 2s ease;}
.metric-bar.green{background:var(--green);box-shadow:0 0 6px rgba(0,255,65,0.4);}
.metric-bar.red{background:var(--red);box-shadow:0 0 6px var(--red-glow);}
.metric-val{width:38px;text-align:right;color:var(--amber);font-size:9px;}

/* ── PANNEAU ALERTE ──────────────────────────────────────── */
#panel-alert{flex:1;display:none;align-items:center;justify-content:center;}
#panel-alert.show{display:flex;}
#alert-inner{
  font-family:var(--vt);font-size:20px;color:var(--red);
  letter-spacing:3px;text-align:center;
  text-shadow:0 0 16px var(--red),0 0 30px rgba(255,34,0,0.3);
  animation:alertPulse 1s ease-in-out infinite;
}
@keyframes alertPulse{0%,100%{opacity:1}50%{opacity:0.4}}

/* ── PANNEAU NAVIGATION ──────────────────────────────────── */
#panel-nav{flex:1;min-width:0;}
.nav-data{font-family:var(--mono);font-size:9px;color:var(--amber-dim);padding:2px 0;letter-spacing:1px;}
.nav-data .nv{color:var(--amber);}

/* ── BOUTON TRANSITION ───────────────────────────────────── */
#transition-btn{
  display:none;
  position:fixed;bottom:30px;left:50%;transform:translateX(-50%);
  font-family:var(--vt);font-size:26px;
  color:#000;background:var(--amber);
  border:none;padding:10px 36px;cursor:pointer;
  letter-spacing:4px;z-index:6000;
  animation:btnAppear 0.5s ease forwards, btnPulse2 2s ease-in-out infinite;
}
@keyframes btnAppear{from{opacity:0;transform:translateX(-50%) translateY(20px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}
@keyframes btnPulse2{0%,100%{box-shadow:0 0 15px var(--amber)}50%{box-shadow:0 0 40px var(--amber),0 0 80px rgba(255,170,0,0.3)}}
#transition-btn:hover{background:#fff;}

/* ── OVERRIDE OVERLAY ────────────────────────────────────── */
#override-overlay{
  display:none;position:fixed;inset:0;
  background:rgba(255,0,0,0.04);
  pointer-events:none;z-index:5000;
  animation:overrideFlash 0.3s ease-in-out 3;
}
#override-overlay.show{display:block;}
@keyframes overrideFlash{0%{background:rgba(255,0,0,0.12)}100%{background:rgba(255,0,0,0.03)}}

/* ── RÉTICULE CURSEUR ────────────────────────────────────── */
#cursor-cross{
  position:fixed;pointer-events:none;z-index:8500;
  width:20px;height:20px;margin:-10px 0 0 -10px;
  opacity:0.7;transition:opacity 0.3s;
}
#cursor-cross::before,#cursor-cross::after{
  content:'';position:absolute;background:var(--amber);
  box-shadow:0 0 4px var(--amber);
}
#cursor-cross::before{width:1px;height:100%;left:50%;transform:translateX(-50%);}
#cursor-cross::after{width:100%;height:1px;top:50%;transform:translateY(-50%);}

/* ── MOBILE ─────────────────────────────────────────────── */
@media(max-width:700px){
  #panel-crew{display:none;}
  #panel-ship{flex:1.5;}
  #panel-radar{display:none;}
  #terminal-out{font-size:15px;}
  #hdr-title-txt{font-size:15px;letter-spacing:2px;}
  #boot-logo pre{font-size:8px;}
}
</style>
</head>
<body>

<!-- Curseur réticule -->
<div id="cursor-cross"></div>

<!-- Overlay effets visuels -->
<div id="overlay-scanlines"></div>
<div id="overlay-phosphor"></div>
<div id="overlay-vignette"></div>
<div id="override-overlay"></div>

<!-- ÉCRAN DE DÉMARRAGE -->
<div id="boot-screen">
  <div id="boot-logo"><pre>
██╗  ██╗██╗   ██╗██████╗  ██████╗ ███╗   ██╗███████╗██╗  ██╗
██║ ██╔╝╚██╗ ██╔╝██╔══██╗██╔═══██╗████╗  ██║██╔════╝╚██╗██╔╝
█████╔╝  ╚████╔╝ ██████╔╝██║   ██║██╔██╗ ██║█████╗   ╚███╔╝
██╔═██╗   ╚██╔╝  ██╔══██╗██║   ██║██║╚██╗██║██╔══╝   ██╔██╗
██║  ██╗   ██║   ██║  ██║╚██████╔╝██║ ╚████║███████╗██╔╝ ██╗
╚═╝  ╚═╝   ╚═╝   ╚═╝  ╚═╝ ╚═════╝ ╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝
              DEEP SPACE VESSEL  ·  K-1979 FRANCO
         ARTIFICIAL INTELLIGENCE MANAGEMENT SYSTEM
  </pre></div>
  <button id="start-btn" onclick="initSystem()">▶  ACTIVER SYSTÈME</button>
</div>

<!-- INTERFACE PRINCIPALE -->
<div id="main">
  <!-- Barre haute -->
  <div id="row-top">
    <div id="hdr-bar">
      <div id="hdr-title-txt">MU-TH-UR 9000 // SYSTÈME DE GESTION KYRONEX</div>
      <div id="hdr-right">
        <span><span class="blink-dot" id="dot-power"></span>ALIMENTATION</span>
        <span><span class="blink-dot" id="dot-ai"></span>IA ACTIVE</span>
        <span id="sys-clock">00:00:00</span>
        <span id="sys-date">STARDATE ---</span>
      </div>
    </div>
  </div>

  <!-- Zone centrale -->
  <div id="row-mid">
    <!-- Schéma vaisseau -->
    <div class="panel" id="panel-ship">
      <div class="pnl-hdr">SCHÉMA STRUCTUREL — K-1979 FRANCO <span id="ship-status">NOMINAL</span></div>
      <div class="pnl-body" style="padding:4px;">
        <svg id="ship-svg" viewBox="0 0 500 200" preserveAspectRatio="xMidYMid meet">
          <defs>
            <filter id="glow-amber">
              <feGaussianBlur stdDeviation="2" result="blur"/>
              <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
            </filter>
            <filter id="glow-green">
              <feGaussianBlur stdDeviation="1.5" result="blur"/>
              <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
            </filter>
            <filter id="glow-red">
              <feGaussianBlur stdDeviation="3" result="blur"/>
              <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
            </filter>
          </defs>

          <!-- Coque principale -->
          <g stroke="#7a4f00" fill="none" stroke-width="0.8">
            <!-- Fuselage central -->
            <rect x="60" y="80" width="340" height="40" rx="3" stroke="#ffaa00" stroke-width="1" filter="url(#glow-amber)"/>
            <!-- Nez effilé -->
            <path d="M60,80 L30,98 L30,102 L60,120" stroke="#ffaa00" stroke-width="1" filter="url(#glow-amber)"/>
            <!-- Pointe avant -->
            <path d="M30,98 L10,100 L30,102" stroke="#ffaa00" stroke-width="0.8"/>
            <!-- Pylônes moteurs -->
            <line x1="380" y1="95" x2="380" y2="65" stroke="#ffaa00"/>
            <line x1="380" y1="105" x2="380" y2="135" stroke="#ffaa00"/>
            <!-- Pods moteurs haut -->
            <rect x="380" y="52" width="60" height="13" rx="2" stroke="#ffaa00" stroke-width="0.8"/>
            <!-- Pods moteurs bas -->
            <rect x="380" y="135" width="60" height="13" rx="2" stroke="#ffaa00" stroke-width="0.8"/>
            <!-- Moteur central -->
            <rect x="395" y="92" width="60" height="16" rx="3" stroke="#ffaa00" stroke-width="1"/>
            <!-- Tuyères -->
            <path d="M455,54 L468,58 L468,63 L455,65" stroke="#ffaa00" stroke-width="0.6"/>
            <path d="M455,135 L468,138 L468,143 L455,148" stroke="#ffaa00" stroke-width="0.6"/>
            <path d="M455,92 L470,95 L470,103 L455,108" stroke="#ffaa00" stroke-width="0.8"/>

            <!-- Sections internes -->
            <line x1="100" y1="80" x2="100" y2="120" stroke="#7a4f00" stroke-width="0.5"/>
            <line x1="160" y1="80" x2="160" y2="120" stroke="#7a4f00" stroke-width="0.5"/>
            <line x1="240" y1="80" x2="240" y2="120" stroke="#7a4f00" stroke-width="0.5"/>
            <line x1="330" y1="80" x2="330" y2="120" stroke="#7a4f00" stroke-width="0.5"/>

            <!-- Dôme pont de commandement -->
            <ellipse cx="110" cy="80" rx="25" ry="10" stroke="#ffaa00" stroke-width="0.8" opacity="0.7"/>
            <!-- Antennes -->
            <line x1="250" y1="80" x2="250" y2="55" stroke="#ffaa00" stroke-width="0.5"/>
            <line x1="250" y1="55" x2="262" y2="48" stroke="#ffaa00" stroke-width="0.5"/>
            <line x1="250" y1="55" x2="238" y2="48" stroke="#ffaa00" stroke-width="0.5"/>
            <circle cx="262" cy="48" r="2" fill="#ffaa00" opacity="0.8"/>
            <circle cx="238" cy="48" r="2" fill="#ffaa00" opacity="0.8"/>
          </g>

          <!-- Indicateurs lumineux (points d'état) -->
          <g id="ship-lights">
            <circle cx="80" cy="100" r="2.5" fill="#00ff41" filter="url(#glow-green)" id="sl-1">
              <animate attributeName="opacity" values="1;0.3;1" dur="2.1s" repeatCount="indefinite"/>
            </circle>
            <circle cx="130" cy="100" r="2" fill="#00ff41" filter="url(#glow-green)" id="sl-2">
              <animate attributeName="opacity" values="1;0.2;1" dur="1.7s" repeatCount="indefinite"/>
            </circle>
            <circle cx="200" cy="100" r="2.5" fill="#ffaa00" filter="url(#glow-amber)" id="sl-3">
              <animate attributeName="opacity" values="1;0.4;1" dur="3s" repeatCount="indefinite"/>
            </circle>
            <circle cx="285" cy="100" r="2" fill="#00ff41" filter="url(#glow-green)" id="sl-4">
              <animate attributeName="opacity" values="1;0.3;1" dur="2.5s" repeatCount="indefinite"/>
            </circle>
            <circle cx="355" cy="100" r="2.5" fill="#00ff41" filter="url(#glow-green)" id="sl-5">
              <animate attributeName="opacity" values="0.3;1;0.3" dur="1.9s" repeatCount="indefinite"/>
            </circle>
            <!-- Lumière de tuyère -->
            <ellipse cx="469" cy="100" rx="3" ry="8" fill="#ffaa00" opacity="0.6" filter="url(#glow-amber)" id="engine-glow">
              <animate attributeName="opacity" values="0.4;0.9;0.4" dur="0.4s" repeatCount="indefinite"/>
              <animate attributeName="ry" values="6;9;6" dur="0.4s" repeatCount="indefinite"/>
            </ellipse>
          </g>

          <!-- Scanner sweep sur le schéma -->
          <line id="ship-scan" x1="60" y1="70" x2="60" y2="140" stroke="rgba(255,170,0,0.4)" stroke-width="1.5">
            <animate attributeName="x1" values="60;450;60" dur="5s" repeatCount="indefinite"/>
            <animate attributeName="x2" values="60;450;60" dur="5s" repeatCount="indefinite"/>
          </line>

          <!-- Labels sections -->
          <g font-family="'VT323',monospace" font-size="9" fill="#7a4f00" text-anchor="middle">
            <text x="80" y="74">PONT</text>
            <text x="130" y="74">CMD</text>
            <text x="200" y="74">CRYOGÉNIE</text>
            <text x="285" y="74">FRET</text>
            <text x="355" y="74">RÉACTEUR</text>
            <text x="430" y="48">POD SUP.</text>
            <text x="430" y="158">POD INF.</text>
            <text x="430" y="104" fill="#ffaa00">PROPULSION</text>
          </g>

          <!-- Grille background subtile -->
          <g stroke="rgba(255,170,0,0.05)" stroke-width="0.5">
            <line x1="0" y1="50" x2="500" y2="50"/><line x1="0" y1="100" x2="500" y2="100"/>
            <line x1="0" y1="150" x2="500" y2="150"/>
            <line x1="100" y1="0" x2="100" y2="200"/><line x1="200" y1="0" x2="200" y2="200"/>
            <line x1="300" y1="0" x2="300" y2="200"/><line x1="400" y1="0" x2="400" y2="200"/>
          </g>

          <!-- Alerte section (cachée initialement) -->
          <rect id="alert-overlay" x="330" y="78" width="52" height="44" fill="rgba(255,34,0,0.12)" stroke="#ff2200" stroke-width="1" opacity="0" filter="url(#glow-red)">
            <animate id="alert-anim" attributeName="opacity" values="0;0.8;0" dur="1s" repeatCount="0"/>
          </rect>
        </svg>
      </div>
    </div>

    <!-- Terminal central IA -->
    <div class="panel" id="panel-terminal">
      <div class="pnl-hdr">MU-TH-UR 9000 — SORTIE PRINCIPALE <span id="pnl-mode">MODE : VEILLE</span></div>
      <div class="pnl-body" style="padding:6px 8px;">
        <div id="terminal-out"></div>
      </div>
    </div>

    <!-- Radar -->
    <div class="panel" id="panel-radar">
      <div class="pnl-hdr">PROXIMITÉ SECTORIELLE <span>PORTÉE : 2.4 UA</span></div>
      <div class="pnl-body" style="padding:2px;display:flex;align-items:center;justify-content:center;">
        <svg id="radar-svg" viewBox="0 0 140 140" style="width:100%;max-height:100%;">
          <!-- Cercles radar -->
          <circle cx="70" cy="70" r="65" fill="none" stroke="rgba(255,170,0,0.15)" stroke-width="0.5"/>
          <circle cx="70" cy="70" r="48" fill="none" stroke="rgba(255,170,0,0.15)" stroke-width="0.5"/>
          <circle cx="70" cy="70" r="32" fill="none" stroke="rgba(255,170,0,0.2)" stroke-width="0.5"/>
          <circle cx="70" cy="70" r="16" fill="none" stroke="rgba(255,170,0,0.25)" stroke-width="0.5"/>
          <!-- Croix -->
          <line x1="70" y1="5" x2="70" y2="135" stroke="rgba(255,170,0,0.1)" stroke-width="0.5"/>
          <line x1="5" y1="70" x2="135" y2="70" stroke="rgba(255,170,0,0.1)" stroke-width="0.5"/>
          <!-- Sweep radar -->
          <g id="radar-sweep">
            <path d="M70,70 L135,70 A65,65 0 0,1 95,126 Z" fill="rgba(255,170,0,0.07)"/>
            <line x1="70" y1="70" x2="135" y2="70" stroke="rgba(255,170,0,0.6)" stroke-width="1"/>
            <animateTransform attributeName="transform" type="rotate" from="0 70 70" to="360 70 70" dur="4s" repeatCount="indefinite"/>
          </g>
          <!-- Point vaisseau (centre) -->
          <circle cx="70" cy="70" r="3" fill="#ffaa00" filter="url(#glow-amber)">
            <animate attributeName="r" values="2;4;2" dur="2s" repeatCount="indefinite"/>
          </circle>
          <!-- Contact mystérieux -->
          <circle id="radar-contact" cx="110" cy="38" r="2.5" fill="#ff2200" opacity="0">
            <animate attributeName="opacity" values="0;1;0" dur="4s" begin="25s" repeatCount="indefinite"/>
          </circle>
          <!-- Labels distance -->
          <text x="72" y="26" font-family="'VT323'" font-size="8" fill="rgba(255,170,0,0.4)">2.4</text>
          <text x="72" y="43" font-family="'VT323'" font-size="8" fill="rgba(255,170,0,0.4)">1.7</text>
          <text x="72" y="59" font-family="'VT323'" font-size="8" fill="rgba(255,170,0,0.4)">1.1</text>
          <text x="72" y="74" font-family="'VT323'" font-size="8" fill="rgba(255,170,0,0.4)">0.5</text>
        </svg>
      </div>
    </div>

    <!-- Status équipage -->
    <div class="panel" id="panel-crew">
      <div class="pnl-hdr">ÉTAT ÉQUIPAGE</div>
      <div class="pnl-body" style="padding:0;overflow:hidden;">
        <div class="crew-entry ok" id="cr-1">
          <div class="cn">GELINNE E.</div>
          <div style="font-size:9px;">COMMANDANT<span class="cs">CRYO ●</span></div>
        </div>
        <div class="crew-entry ok" id="cr-2">
          <div class="cn">CEDRIC M.</div>
          <div style="font-size:9px;">INGÉNIEUR<span class="cs">CRYO ●</span></div>
        </div>
        <div class="crew-entry ok" id="cr-3">
          <div class="cn">KR95</div>
          <div style="font-size:9px;">COMM. RADIO<span class="cs">CRYO ●</span></div>
        </div>
        <div class="crew-entry ok" id="cr-4">
          <div class="cn">DAMON P.</div>
          <div style="font-size:9px;">PILOTE<span class="cs">CRYO ●</span></div>
        </div>
        <div class="crew-entry ok" id="cr-5">
          <div class="cn">GEOFFREY V.</div>
          <div style="font-size:9px;">TECHNICIEN<span class="cs">CRYO ●</span></div>
        </div>
        <div style="margin-top:6px;padding:4px 6px;">
          <div style="font-family:var(--mono);font-size:9px;color:var(--amber-dim);letter-spacing:1px;margin-bottom:4px;">PRESSION CAPSULES</div>
          <div class="metric-row">
            <div class="metric-label">CR-01</div>
            <div class="metric-bar-wrap"><div class="metric-bar green" id="cryo-1" style="width:94%"></div></div>
            <div class="metric-val" style="color:var(--green)">94%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">CR-02</div>
            <div class="metric-bar-wrap"><div class="metric-bar green" id="cryo-2" style="width:91%"></div></div>
            <div class="metric-val" style="color:var(--green)">91%</div>
          </div>
          <div class="metric-row">
            <div class="metric-label">CR-03</div>
            <div class="metric-bar-wrap"><div class="metric-bar green" id="cryo-3" style="width:96%"></div></div>
            <div class="metric-val" style="color:var(--green)">96%</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Barre basse -->
  <div id="row-bot">
    <!-- Navigation -->
    <div class="panel" id="panel-nav">
      <div class="pnl-hdr">NAVIGATION & TELÉMÉTRIE</div>
      <div class="pnl-body">
        <div class="nav-data">SECTEUR : <span class="nv" id="nav-sec">---</span></div>
        <div class="nav-data">COORD. : <span class="nv" id="nav-coord">---</span></div>
        <div class="nav-data">DEST. : <span class="nv" id="nav-dest">---</span></div>
        <div class="nav-data">VITESSE : <span class="nv" id="nav-spd">---</span></div>
      </div>
    </div>

    <!-- Métriques système -->
    <div class="panel" id="panel-metrics">
      <div class="pnl-hdr">SYSTÈMES VITAUX</div>
      <div class="pnl-body">
        <div class="metric-row">
          <div class="metric-label">RÉACTEUR</div>
          <div class="metric-bar-wrap"><div class="metric-bar" id="m-reactor" style="width:0%"></div></div>
          <div class="metric-val" id="mv-reactor">0%</div>
        </div>
        <div class="metric-row">
          <div class="metric-label">PROPULSION</div>
          <div class="metric-bar-wrap"><div class="metric-bar green" id="m-prop" style="width:0%"></div></div>
          <div class="metric-val" id="mv-prop">0%</div>
        </div>
        <div class="metric-row">
          <div class="metric-label">ATMO. INT.</div>
          <div class="metric-bar-wrap"><div class="metric-bar green" id="m-atmo" style="width:0%"></div></div>
          <div class="metric-val" id="mv-atmo">0%</div>
        </div>
        <div class="metric-row">
          <div class="metric-label">IA CŒUR</div>
          <div class="metric-bar-wrap"><div class="metric-bar" id="m-ai" style="width:0%"></div></div>
          <div class="metric-val" id="mv-ai">0%</div>
        </div>
        <div class="metric-row">
          <div class="metric-label">COMMS</div>
          <div class="metric-bar-wrap"><div class="metric-bar green" id="m-comms" style="width:0%"></div></div>
          <div class="metric-val" id="mv-comms">0%</div>
        </div>
      </div>
    </div>

    <!-- Alerte -->
    <div class="panel" id="panel-alert">
      <div id="alert-inner">⚠ DIRECTIVE SIGMA ROUGE ACTIVE ⚠<br><span style="font-size:14px;letter-spacing:2px;">ORDRE SPÉCIAL FRANCO-001</span></div>
    </div>
  </div>
</div>

<!-- Bouton transition -->
<button id="transition-btn" onclick="goToKitt()">
  ▶  ACCÉDER À L'INTERFACE KITT
</button>

<script>
// ════════════════════════════════════════════════════════════
// CURSEUR RÉTICULE
// ════════════════════════════════════════════════════════════
const cross = document.getElementById('cursor-cross');
document.addEventListener('mousemove', e => {
  cross.style.left = e.clientX + 'px';
  cross.style.top  = e.clientY + 'px';
});

// ════════════════════════════════════════════════════════════
// AUDIO ENGINE — TOUT SYNTHÉTISÉ
// ════════════════════════════════════════════════════════════
let AC, masterGain, reverbNode;

function initAudio() {
  AC = new (window.AudioContext || window.webkitAudioContext)();
  masterGain = AC.createGain();
  masterGain.gain.value = 0.0;
  masterGain.connect(AC.destination);
  // Fondu d'entrée
  masterGain.gain.linearRampToValueAtTime(1.0, AC.currentTime + 4);

  // Nœud de reverb (delay en boucle pour simuler l'espace)
  reverbNode = createReverb();

  startAmbience();
  startHeartbeat();
  startHighFreqHum();
  startAtmosphericNoise();
}

// Reverb simulé avec delay en boucle
function createReverb() {
  const delay = AC.createDelay(2.0);
  delay.delayTime.value = 0.35;
  const feedback = AC.createGain();
  feedback.gain.value = 0.45;
  const filter = AC.createBiquadFilter();
  filter.type = 'lowpass';
  filter.frequency.value = 900;
  const wetGain = AC.createGain();
  wetGain.gain.value = 0.35;
  delay.connect(feedback);
  feedback.connect(filter);
  filter.connect(delay);
  delay.connect(wetGain);
  wetGain.connect(masterGain);
  return delay;
}

// ── Drone ambiant (couche basse — 2 oscillateurs désaccordés) ──
function startAmbience() {
  const t = AC.currentTime;
  // Oscillateur 1 — Fa grave
  const o1 = AC.createOscillator();
  o1.type = 'sine';
  o1.frequency.value = 43.65; // F1
  const g1 = AC.createGain(); g1.gain.value = 0;
  g1.gain.linearRampToValueAtTime(0.32, t + 5);
  o1.connect(g1); g1.connect(masterGain);
  g1.connect(reverbNode);
  o1.start();

  // Oscillateur 2 — légèrement désaccordé (battement)
  const o2 = AC.createOscillator();
  o2.type = 'sine';
  o2.frequency.value = 44.8;
  const g2 = AC.createGain(); g2.gain.value = 0;
  g2.gain.linearRampToValueAtTime(0.28, t + 6);
  o2.connect(g2); g2.connect(masterGain);
  g2.connect(reverbNode);
  o2.start();

  // Oscillateur 3 — harmonique (Do2 ~65Hz)
  const o3 = AC.createOscillator();
  o3.type = 'triangle';
  o3.frequency.value = 65.4;
  const g3 = AC.createGain(); g3.gain.value = 0;
  g3.gain.linearRampToValueAtTime(0.12, t + 8);
  // LFO sur amplitude de o3
  const lfo3 = AC.createOscillator();
  lfo3.type = 'sine'; lfo3.frequency.value = 0.07;
  const lfoG3 = AC.createGain(); lfoG3.gain.value = 0.06;
  lfo3.connect(lfoG3); lfoG3.connect(g3.gain);
  lfo3.start();
  o3.connect(g3); g3.connect(masterGain); g3.connect(reverbNode);
  o3.start();

  // Couche dissonante (tension) — si bémol grave ~58Hz
  const o4 = AC.createOscillator();
  o4.type = 'sawtooth';
  o4.frequency.value = 58.27;
  const lp4 = AC.createBiquadFilter(); lp4.type = 'lowpass'; lp4.frequency.value = 200;
  const g4 = AC.createGain(); g4.gain.value = 0;
  g4.gain.linearRampToValueAtTime(0.08, t + 10);
  // LFO lent sur fréquence
  const lfo4 = AC.createOscillator();
  lfo4.type = 'sine'; lfo4.frequency.value = 0.03;
  const lfoG4 = AC.createGain(); lfoG4.gain.value = 4;
  lfo4.connect(lfoG4); lfoG4.connect(o4.frequency);
  lfo4.start();
  o4.connect(lp4); lp4.connect(g4); g4.connect(masterGain); g4.connect(reverbNode);
  o4.start();

  // Pad harmonique — La3 ~220Hz, très filtré, ambiant
  const o5 = AC.createOscillator();
  o5.type = 'sine';
  o5.frequency.value = 220;
  const lp5 = AC.createBiquadFilter(); lp5.type = 'lowpass'; lp5.frequency.value = 350;
  const g5 = AC.createGain(); g5.gain.value = 0;
  g5.gain.linearRampToValueAtTime(0.06, t + 12);
  const lfo5 = AC.createOscillator();
  lfo5.type = 'sine'; lfo5.frequency.value = 0.11;
  const lfoG5 = AC.createGain(); lfoG5.gain.value = 0.04;
  lfo5.connect(lfoG5); lfoG5.connect(g5.gain);
  lfo5.start();
  o5.connect(lp5); lp5.connect(g5); g5.connect(masterGain); g5.connect(reverbNode);
  o5.start();
}

// ── Battement de cœur (tension psychologique) ──────────────
let heartbeatInterval;
function startHeartbeat() {
  beatHeart(0.8); // premier battement immédiat
  heartbeatInterval = setInterval(() => beatHeart(0.8), 2200);
}

function beatHeart(vol = 0.8) {
  if (!AC) return;
  const t = AC.currentTime;
  // Battement 1
  singleBeat(t, vol);
  // Battement 2 (plus doux, légèrement après)
  singleBeat(t + 0.22, vol * 0.6);
}

function singleBeat(t, vol) {
  const o = AC.createOscillator();
  o.type = 'sine';
  o.frequency.setValueAtTime(120, t);
  o.frequency.exponentialRampToValueAtTime(35, t + 0.12);
  const g = AC.createGain();
  g.gain.setValueAtTime(0, t);
  g.gain.linearRampToValueAtTime(vol * 0.6, t + 0.01);
  g.gain.exponentialRampToValueAtTime(0.001, t + 0.18);
  const comp = AC.createDynamicsCompressor();
  o.connect(comp); comp.connect(g); g.connect(masterGain);
  o.start(t); o.stop(t + 0.2);
}

// ── Bourdonnement haute fréquence (électronique) ───────────
function startHighFreqHum() {
  const t = AC.currentTime;
  const o = AC.createOscillator();
  o.type = 'sawtooth';
  o.frequency.value = 183;
  const bp = AC.createBiquadFilter(); bp.type = 'bandpass'; bp.frequency.value = 183; bp.Q.value = 12;
  const g = AC.createGain(); g.gain.value = 0;
  g.gain.linearRampToValueAtTime(0.04, t + 3);
  // LFO subtil
  const lfo = AC.createOscillator();
  lfo.type = 'triangle'; lfo.frequency.value = 0.25;
  const lfoG = AC.createGain(); lfoG.gain.value = 0.01;
  lfo.connect(lfoG); lfoG.connect(g.gain); lfo.start();
  o.connect(bp); bp.connect(g); g.connect(masterGain);
  o.start();
}

// ── Bruit atmosphérique (souffle spatial) ──────────────────
function startAtmosphericNoise() {
  const bufSize = AC.sampleRate * 3;
  const buf = AC.createBuffer(1, bufSize, AC.sampleRate);
  const data = buf.getChannelData(0);
  for (let i = 0; i < bufSize; i++) data[i] = Math.random() * 2 - 1;
  const src = AC.createBufferSource();
  src.buffer = buf; src.loop = true;
  const lp = AC.createBiquadFilter(); lp.type = 'lowpass'; lp.frequency.value = 280;
  const hp = AC.createBiquadFilter(); hp.type = 'highpass'; hp.frequency.value = 60;
  const g = AC.createGain(); g.gain.value = 0;
  g.gain.linearRampToValueAtTime(0.022, AC.currentTime + 4);
  // LFO très lent sur volume
  const lfo = AC.createOscillator();
  lfo.type = 'sine'; lfo.frequency.value = 0.04;
  const lfoG = AC.createGain(); lfoG.gain.value = 0.008;
  lfo.connect(lfoG); lfoG.connect(g.gain); lfo.start();
  src.connect(lp); lp.connect(hp); hp.connect(g);
  g.connect(masterGain); g.connect(reverbNode);
  src.start();
}

// ── Bip de données (à la frappe) ───────────────────────────
let _charCount = 0;
function typeBeep() {
  if (!AC) return;
  _charCount++;
  const t = AC.currentTime;
  const r = Math.random();
  // Glitch rare
  if (_charCount % 53 === 0) {
    const len = Math.floor(AC.sampleRate * 0.025);
    const buf = AC.createBuffer(1, len, AC.sampleRate);
    const d = buf.getChannelData(0);
    for (let i = 0; i < len; i++) d[i] = (Math.random()*2-1) * (Math.random() > 0.6 ? 0.7 : 0.05);
    const src = AC.createBufferSource(); src.buffer = buf;
    const bp = AC.createBiquadFilter(); bp.type = 'bandpass'; bp.frequency.value = 800; bp.Q.value = 3;
    const g = AC.createGain(); g.gain.value = 0.08;
    src.connect(bp); bp.connect(g); g.connect(masterGain);
    src.start(); return;
  }
  if (r < 0.55) { // frappe principale
    const o = AC.createOscillator();
    o.type = 'square';
    o.frequency.setValueAtTime(1100 + Math.random()*200, t);
    o.frequency.exponentialRampToValueAtTime(700, t + 0.018);
    const g = AC.createGain();
    g.gain.setValueAtTime(0.035, t);
    g.gain.exponentialRampToValueAtTime(0.001, t + 0.022);
    o.connect(g); g.connect(masterGain);
    o.start(t); o.stop(t + 0.025);
  } else if (r < 0.75) { // tick discret
    const o = AC.createOscillator();
    o.type = 'triangle';
    o.frequency.value = 3200 + Math.random()*400;
    const g = AC.createGain();
    g.gain.setValueAtTime(0.018, t);
    g.gain.exponentialRampToValueAtTime(0.001, t + 0.012);
    o.connect(g); g.connect(masterGain);
    o.start(t); o.stop(t + 0.015);
  }
  // ~25% silence = naturel
}

// ── Son fin de ligne ────────────────────────────────────────
function lineEndBeep() {
  if (!AC) return;
  const t = AC.currentTime;
  const o = AC.createOscillator(); o.type = 'sine';
  o.frequency.setValueAtTime(660, t);
  o.frequency.exponentialRampToValueAtTime(440, t + 0.08);
  const g = AC.createGain();
  g.gain.setValueAtTime(0.04, t);
  g.gain.exponentialRampToValueAtTime(0.001, t + 0.1);
  o.connect(g); g.connect(masterGain); g.connect(reverbNode);
  o.start(t); o.stop(t + 0.12);
}

// ── Chime IA (démarrage) ────────────────────────────────────
function aiChime() {
  if (!AC) return;
  const t = AC.currentTime;
  const freqs = [261.63, 329.63, 392.00, 523.25];
  freqs.forEach((f, i) => {
    const o = AC.createOscillator(); o.type = 'sine'; o.frequency.value = f;
    const g = AC.createGain();
    g.gain.setValueAtTime(0, t + i * 0.15);
    g.gain.linearRampToValueAtTime(0.12, t + i * 0.15 + 0.05);
    g.gain.exponentialRampToValueAtTime(0.001, t + i * 0.15 + 0.5);
    o.connect(g); g.connect(masterGain); g.connect(reverbNode);
    o.start(t + i * 0.15); o.stop(t + i * 0.15 + 0.55);
  });
}

// ── Son ALERTE (override) ────────────────────────────────────
function alertSound() {
  if (!AC) return;
  const t = AC.currentTime;
  // Alarme triphasée
  for (let i = 0; i < 3; i++) {
    const o = AC.createOscillator(); o.type = 'square';
    o.frequency.setValueAtTime(880, t + i * 0.4);
    o.frequency.setValueAtTime(660, t + i * 0.4 + 0.2);
    const g = AC.createGain();
    g.gain.setValueAtTime(0.12, t + i * 0.4);
    g.gain.setValueAtTime(0.08, t + i * 0.4 + 0.2);
    g.gain.exponentialRampToValueAtTime(0.001, t + i * 0.4 + 0.38);
    const hp = AC.createBiquadFilter(); hp.type = 'highpass'; hp.frequency.value = 400;
    o.connect(hp); hp.connect(g); g.connect(masterGain);
    o.start(t + i * 0.4); o.stop(t + i * 0.4 + 0.39);
  }
  // Basse d'impact
  const ob = AC.createOscillator(); ob.type = 'sine';
  ob.frequency.setValueAtTime(80, t);
  ob.frequency.exponentialRampToValueAtTime(30, t + 0.3);
  const gb = AC.createGain();
  gb.gain.setValueAtTime(0.4, t);
  gb.gain.exponentialRampToValueAtTime(0.001, t + 0.4);
  ob.connect(gb); gb.connect(masterGain);
  ob.start(t); ob.stop(t + 0.45);
}

// ── Bip "voix IA" (tones mélodiques pour simuler voix synthétique) ──
let voiceActive = false;
function startVoiceTone(freq, dur) {
  if (!AC) return;
  const t = AC.currentTime;
  const o = AC.createOscillator(); o.type = 'sine';
  const o2 = AC.createOscillator(); o2.type = 'square';
  o.frequency.value = freq;
  o2.frequency.value = freq * 1.5;
  const lp = AC.createBiquadFilter(); lp.type = 'bandpass'; lp.frequency.value = freq; lp.Q.value = 3;
  const g = AC.createGain();
  g.gain.setValueAtTime(0, t);
  g.gain.linearRampToValueAtTime(0.08, t + 0.02);
  g.gain.setValueAtTime(0.08, t + dur - 0.03);
  g.gain.linearRampToValueAtTime(0, t + dur);
  const g2 = AC.createGain(); g2.gain.value = 0.025;
  o.connect(lp); lp.connect(g); g.connect(masterGain); g.connect(reverbNode);
  o2.connect(g2); g2.connect(masterGain);
  o.start(t); o.stop(t + dur + 0.01);
  o2.start(t); o2.stop(t + dur + 0.01);
}

// Augmenter tension lors de l'override
function increaseTension() {
  if (!AC) return;
  // Ajoute un bourdon plus grave et dissonant
  const t = AC.currentTime;
  const o = AC.createOscillator(); o.type = 'sawtooth';
  o.frequency.value = 29.14; // Do#0 — très sombre
  const lp = AC.createBiquadFilter(); lp.type = 'lowpass'; lp.frequency.value = 180;
  const g = AC.createGain(); g.gain.value = 0;
  g.gain.linearRampToValueAtTime(0.25, t + 3);
  o.connect(lp); lp.connect(g); g.connect(masterGain); g.connect(reverbNode);
  o.start();
  // Tremolo rapide
  const lfo = AC.createOscillator();
  lfo.type = 'sine'; lfo.frequency.value = 6;
  const lfoG = AC.createGain(); lfoG.gain.value = 0.07;
  lfo.connect(lfoG); lfoG.connect(g.gain); lfo.start();
}

// ════════════════════════════════════════════════════════════
// SÉQUENCEUR — NARRATIVE CINÉMATIQUE
// ════════════════════════════════════════════════════════════
const term = document.getElementById('terminal-out');
let _typing = false;

function delay(ms) { return new Promise(r => setTimeout(r, ms)); }

function typeLine(text, speed = 45, cls = '') {
  return new Promise(resolve => {
    _typing = true;
    const div = document.createElement('div');
    div.className = 't-line' + (cls ? ' ' + cls : '');
    const cur = document.createElement('span'); cur.className = 't-cursor';
    div.appendChild(cur);
    term.appendChild(div);
    term.scrollTop = term.scrollHeight;
    let i = 0;
    function tick() {
      if (i < text.length) {
        div.insertBefore(document.createTextNode(text[i++]), cur);
        typeBeep();
        term.scrollTop = term.scrollHeight;
        setTimeout(tick, speed + Math.random() * (speed * 0.5));
      } else {
        cur.remove();
        if (text.trim()) lineEndBeep();
        _typing = false;
        resolve();
      }
    }
    tick();
  });
}

function addBlank() {
  const d = document.createElement('div'); d.style.height = '5px';
  term.appendChild(d);
}

// Mise à jour métriques avec animation
function setMetric(id, valId, pct, delayed = 0) {
  setTimeout(() => {
    const bar = document.getElementById(id);
    const val = document.getElementById(valId);
    if (bar) bar.style.width = pct + '%';
    if (val) val.textContent = pct + '%';
  }, delayed);
}

function setNavData(sec, coord, dest, spd) {
  document.getElementById('nav-sec').textContent = sec;
  document.getElementById('nav-coord').textContent = coord;
  document.getElementById('nav-dest').textContent = dest;
  document.getElementById('nav-spd').textContent = spd;
}

// ── Séquence principale ─────────────────────────────────────
async function runSequence() {
  document.getElementById('pnl-mode').textContent = 'MODE : ÉVEIL';
  await delay(600);

  // Phase 1 : Boot IA
  aiChime();
  await delay(300);
  await typeLine('MU-TH-UR 9000 — SÉQUENCE D\'ÉVEIL INITIÉE', 35, 'amber-bright');
  await typeLine('HEURE SYSTÈME : ' + new Date().toISOString().replace('T',' ').slice(0,19) + ' UTC', 25, 'dim');
  await delay(400);

  // Métriques qui montent
  setMetric('m-reactor','mv-reactor', 87, 200);
  setMetric('m-prop','mv-prop', 94, 600);
  setMetric('m-atmo','mv-atmo', 98, 900);
  setMetric('m-ai','mv-ai', 100, 1200);
  setMetric('m-comms','mv-comms', 76, 1500);

  await typeLine('CHARGEMENT MÉMOIRE PRINCIPALE...', 30, 'dim');
  await typeLine('■■■■■■■■■■■■■■■■■■■■ 100%   [OK]', 8, 'green-txt');
  await typeLine('MODULES DE TRAITEMENT COGNITIF... [OK]', 28, 'dim');
  await typeLine('INTERFACE NEURONALE DISTRIBÉE...  [OK]', 28, 'dim');
  await typeLine('SYNTHÈSE VOCALE ACTIVÉE...        [OK]', 28, 'dim');
  addBlank();

  // Phase 2 : Navigation
  await delay(500);
  document.getElementById('pnl-mode').textContent = 'MODE : NAVIGATION';
  await typeLine('──── DONNÉES DE NAVIGATION ────', 15, 'amber');
  await delay(200);
  setNavData('ALPHA CENTAURI B-7','47.3° / -12.8° / 89.1°','EARTH — SECTOR SOL-1','0.42c SUBLIGHT');
  await typeLine('POSITION ACTUELLE : SECTEUR ALPHA-CENTAURI B-7', 28, 'dim');
  await typeLine('TRAJECTOIRE NOMINALE — DÉVIATION : 0.003°', 28, 'green-txt');
  await typeLine('CARBURANT ION : 61.4% — SUFFISANT', 28, 'green-txt');
  addBlank();

  // Phase 3 : Équipage
  await delay(300);
  document.getElementById('pnl-mode').textContent = 'MODE : SURVEILLANCE';
  await typeLine('──── ÉTAT CRYOGÉNIE ÉQUIPAGE ────', 15, 'amber');
  await delay(150);
  // Petite voix synthétique pendant les statuts
  startVoiceTone(220, 0.4);
  await typeLine('CR-01 GELINNE E. . . . . CRYO STABLE  ●', 18, 'green-txt');
  startVoiceTone(261, 0.35);
  await typeLine('CR-02 CEDRIC M. . . . . . CRYO STABLE  ●', 18, 'green-txt');
  startVoiceTone(247, 0.35);
  await typeLine('CR-03 KR95  . . . . . . . CRYO STABLE  ●', 18, 'green-txt');
  startVoiceTone(220, 0.35);
  await typeLine('CR-04 DAMON P.. . . . . . CRYO STABLE  ●', 18, 'green-txt');
  startVoiceTone(196, 0.35);
  await typeLine('CR-05 GEOFFREY V. . . . . CRYO STABLE  ●', 18, 'green-txt');
  addBlank();
  await typeLine('TOUS PERSONNELS EN ÉTAT NOMINAL.', 28, 'green-txt');
  await typeLine('RÉVEIL AUTOMATIQUE DANS : 47J 14H 22M', 28, 'dim');
  addBlank();
  await delay(600);

  // Phase 4 : Interception signal
  document.getElementById('pnl-mode').textContent = 'MODE : RÉCEPTION';
  await typeLine('──── COMMUNICATIONS ────', 15, 'amber');
  await delay(400);
  await typeLine('SIGNAL INTERCEPTÉ — FRÉQUENCE 1420.4 MHz', 30, 'amber');
  await typeLine('ANALYSE EN COURS...', 40, 'dim');
  await delay(800);
  await typeLine('ORIGINE : INCONNUE', 30, 'amber');
  await typeLine('PATTERN : NON RÉPERTORIÉ DANS BASE DE DONNÉES', 28, 'amber');
  await delay(300);
  await typeLine('TRANSMISSION : STRUCTURÉE — NON ALÉATOIRE', 28, 'amber');
  addBlank();

  // Radar contact apparaît
  document.getElementById('radar-contact').style.animation = 'none';
  await delay(100);
  document.getElementById('radar-contact').style.animation = '';
  document.getElementById('radar-contact').setAttribute('opacity', '0.9');

  await delay(1200);

  // Phase 5 : OVERRIDE — LE MOMENT CLEF
  alertSound();
  await delay(200);
  alertSound();

  // Effet visuel flash rouge
  const ov = document.getElementById('override-overlay');
  ov.classList.add('show');
  setTimeout(() => ov.classList.remove('show'), 1500);

  // Les lumières du vaisseau changent
  document.getElementById('sl-5').setAttribute('fill', '#ff2200');
  document.getElementById('ship-status').textContent = '⚠ ALERTE';
  document.getElementById('ship-status').style.color = '#ff2200';

  // Panneau alerte visible
  document.getElementById('panel-alert').classList.add('show');

  addBlank();
  document.getElementById('pnl-mode').textContent = 'MODE : PRIORITÉ SIGMA';

  increaseTension();
  if (heartbeatInterval) {
    clearInterval(heartbeatInterval);
    heartbeatInterval = setInterval(() => beatHeart(1.1), 1400); // plus rapide
  }

  await typeLine('⚠ ⚠ ⚠ INTERCEPTION PRIORITÉ SIGMA ROUGE ⚠ ⚠ ⚠', 12, 'red-txt');
  await delay(600);
  await typeLine('DIRECTIVE ENTRANTE — CHIFFREMENT WEYLAND-92...', 30, 'amber');
  await typeLine('DÉCODAGE... ■■■■■■■■■■■■■■■■■■■■ COMPLÉTÉ', 8, 'amber');
  addBlank();
  await delay(400);

  await typeLine('ÉMETTEUR : WEYLAND CORP. DIVISION FRANCO-BELGE', 25, 'amber');
  await typeLine('DESTINATAIRE : MU-TH-UR 9000 // KYRONEX-K1979', 25, 'amber');
  addBlank();
  await delay(300);
  await typeLine('ORDRE SPÉCIAL FRANCO-001 :', 20, 'red-txt');
  await delay(300);
  await typeLine('  PRIORITÉ ABSOLUE — ÉQUIPAGE SECONDAIRE', 22, 'red-txt');
  await typeLine('  RÉCUPÉRER SOURCE DU SIGNAL EXTRATERRESTRE', 22, 'red-txt');
  await typeLine('  TRANSMETTRE À INTERFACE KITT FRANCO-BELGE', 22, 'red-txt');
  addBlank();
  await typeLine('  DONNÉES REÇUES → TRAITEMENT IA EMBARQUÉE', 22, 'amber');
  await typeLine('  SYSTÈME KITT REQUIS POUR ANALYSE FINALE', 22, 'amber');
  addBlank();

  await delay(500);

  // Voyants équipage changent (pas "danger" mais "réveil précoce")
  document.getElementById('cr-1').className = 'crew-entry warn';
  document.getElementById('cr-1').querySelector('.cs').textContent = 'ÉVEIL ◕';
  await delay(200);
  document.getElementById('cr-2').className = 'crew-entry warn';
  document.getElementById('cr-2').querySelector('.cs').textContent = 'ÉVEIL ◕';

  await typeLine('RÉVEIL ANTICIPÉ COMMANDANT GELINNE — INITIÉ', 28, 'amber');
  await delay(400);
  await typeLine('TRANSFERT VERS INTERFACE CENTRALE KITT...', 30, 'amber');
  addBlank();
  await delay(300);
  await typeLine('MU-TH-UR 9000 — MISSION : PRÊTE.', 20, 'amber-bright');
  addBlank();

  startVoiceTone(440, 0.6);
  await delay(300);
  startVoiceTone(523, 0.5);
  await delay(300);
  startVoiceTone(659, 0.8);

  await delay(600);
  await typeLine('EN ATTENTE DE LA VALIDATION DU COMMANDANT.', 28, 'dim');

  // Afficher bouton transition
  document.getElementById('transition-btn').style.display = 'block';
}

// ════════════════════════════════════════════════════════════
// HORLOGE
// ════════════════════════════════════════════════════════════
function updateClock() {
  const now = new Date();
  document.getElementById('sys-clock').textContent = now.toLocaleTimeString('fr-FR');
  const sd = 'STARDATE ' + now.getFullYear() + '.' + String(now.getMonth()+1).padStart(2,'0') + String(now.getDate()).padStart(2,'0');
  document.getElementById('sys-date').textContent = sd;
}
setInterval(updateClock, 1000);
updateClock();

// ════════════════════════════════════════════════════════════
// INITIALISATION (déclenché par le bouton START)
// ════════════════════════════════════════════════════════════
function initSystem() {
  const bootScreen = document.getElementById('boot-screen');
  bootScreen.style.transition = 'opacity 1s ease';
  bootScreen.style.opacity = '0';
  setTimeout(() => {
    bootScreen.style.display = 'none';
    document.getElementById('main').classList.add('active');
  }, 1000);

  initAudio();

  setTimeout(() => {
    runSequence();
  }, 1500);
}

// ════════════════════════════════════════════════════════════
// TRANSITION VERS KITT
// ════════════════════════════════════════════════════════════
function goToKitt() {
  if (AC) {
    masterGain.gain.linearRampToValueAtTime(0, AC.currentTime + 1.5);
  }
  const all = document.body;
  all.style.transition = 'opacity 1.5s ease';
  all.style.opacity = '0';
  setTimeout(() => {
    // Redirige vers l'interface KITT principale
    // Modifier 'kitt-improved.html' par le nom réel de votre fichier KITT
    window.location.href = 'kitt-improved.html';
  }, 1600);
}

// Curseur custom sur tout le document
document.addEventListener('click', () => {
  cross.style.opacity = '0.3';
  setTimeout(() => { cross.style.opacity = '0.7'; }, 150);
});
</script>
</body>
</html>
